<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clínica Dra. Jaqueline Nobre Moratore | Anamnese</title>
    <link rel="stylesheet" href="style.css">
    <!-- Ícones (Font Awesome) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Biblioteca para captura de assinatura -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/signature_pad/1.5.3/signature_pad.min.js"></script>
    <!-- Biblioteca para gerar PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <!-- Cabeçalho com informações da dentista -->
    <header class="header">
        <div class="container">
            <div class="logo">
                <i class="fas fa-tooth"></i>
                <h1>Dra. Jaqueline Nobre Moratore</h1>
                <p class="subtitle">Odontologia Integrada &amp; Saúde Bucal</p>
            </div>
            <div class="contact-info">
                <p><i class="fas fa-phone-alt"></i> (11) 98470-8439</p>
                <p><i class="fas fa-envelope"></i> jaque.nobre.moratore.odonto@gmail.com</p>
                <p><i class="fas fa-map-marker-alt"></i> Rua Avaré, nº 15, Bairro Matriz, Sala 22, Mauá - SP</p>
                <p><i class="fab fa-instagram"></i> @dentista.jaque</p>
            </div>
        </div>
    </header>

    <main class="container">
        <!-- Introdução -->
        <section class="intro">
            <h2>Formulário de Anamnese</h2>
            <p>Preencha todas as informações abaixo com atenção. Os dados são essenciais para um atendimento seguro e personalizado. Após o preenchimento, você poderá revisar e assinar digitalmente.</p>
        </section>

        <!-- Formulário principal -->
        <form id="anamneseForm" class="form">
            <!-- Dados Pessoais -->
            <fieldset>
                <legend><i class="fas fa-user"></i> Dados Pessoais</legend>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="nome">Nome Completo *</label>
                        <input type="text" id="nome" name="nome" required>
                    </div>
                    <div class="form-group">
                        <label for="nascimento">Data de Nascimento *</label>
                        <input type="date" id="nascimento" name="nascimento" required>
                    </div>
                    <div class="form-group">
                        <label for="genero">Gênero *</label>
                        <select id="genero" name="genero" required>
                            <option value="">Selecione</option>
                            <option value="Feminino">Feminino</option>
                            <option value="Masculino">Masculino</option>
                            <option value="Outro">Outro</option>
                            <option value="Prefiro não informar">Prefiro não informar</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="telefone">Telefone/WhatsApp *</label>
                        <input type="tel" id="telefone" name="telefone" required>
                    </div>
                    <div class="form-group">
                        <label for="email">E-mail *</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    <div class="form-group full-width">
                        <label for="endereco">Endereço Completo *</label>
                        <textarea id="endereco" name="endereco" rows="2" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="profissao">Profissão</label>
                        <input type="text" id="profissao" name="profissao">
                    </div>
                    <div class="form-group">
                        <label for="rg">RG</label>
                        <input type="text" id="rg" name="rg">
                    </div>
                    <div class="form-group">
                        <label for="cpf">CPF *</label>
                        <input type="text" id="cpf" name="cpf" required>
                    </div>
                    <div class="form-group full-width">
                        <label for="autorizaImagem">Autoriza o uso de imagem? *</label>
                        <select id="autorizaImagem" name="autorizaImagem" required>
                            <option value="">Selecione</option>
                            <option value="Sim">Sim</option>
                            <option value="Não">Não</option>
                        </select>
                    </div>
                </div>
            </fieldset>

            <!-- Histórico Médico -->
            <fieldset>
                <legend><i class="fas fa-stethoscope"></i> Histórico Médico</legend>
                <!-- As perguntas condicionais (ex: "Tem preferência musical?") são geradas dinamicamente via JavaScript.
                     A lógica para mostrar/ocultar campos dependendo da resposta (Sim/Não) está em script.js -->
                <div id="historicoMedico">
                    <!-- O conteúdo é preenchido pelo JavaScript -->
                </div>
            </fieldset>

            <!-- Hábitos de Higiene Bucal -->
            <fieldset>
                <legend><i class="fas fa-smile"></i> Hábitos de Higiene Bucal</legend>
                <div id="habitosHigiene">
                    <!-- O conteúdo é preenchido pelo JavaScript -->
                </div>
            </fieldset>

            <!-- Botão de submissão do formulário -->
            <div class="form-actions">
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-check-circle"></i> Revisar e Assinar
                </button>
                <button type="reset" class="btn btn-secondary">
                    <i class="fas fa-redo"></i> Limpar Formulário
                </button>
            </div>
        </form>

        <!-- Seção de Revisão e Assinatura (inicialmente oculta) -->
        <section id="revisaoSection" class="revisao-section" style="display: none;">
            <h2><i class="fas fa-clipboard-check"></i> Revise suas Informações</h2>
            <p>Verifique se todos os dados estão corretos. Em seguida, assine digitalmente no quadro abaixo.</p>

            <div id="resumoRevisao" class="resumo-revisao">
                <!-- O resumo será preenchido pelo JavaScript -->
            </div>

            <div class="assinatura-box">
                <h3>Assinatura Digital *</h3>
                <p>Assine no quadro abaixo usando o mouse ou o dedo (em dispositivos touch).</p>
                <canvas id="signatureCanvas" width="600" height="200"></canvas>
                <div class="assinatura-actions">
                    <button id="clearSignature" type="button" class="btn btn-secondary">
                        <i class="fas fa-eraser"></i> Limpar Assinatura
                    </button>
                    <button id="saveSignature" type="button" class="btn btn-primary">
                        <i class="fas fa-file-signature"></i> Confirmar Assinatura
                    </button>
                </div>
                <p class="assinatura-nota">Ao confirmar, você declara que as informações fornecidas são verdadeiras.</p>
            </div>

            <!-- Botão final para enviar o formulário -->
            <div class="form-actions">
                <button id="enviarFinal" type="button" class="btn btn-success" disabled>
                    <i class="fas fa-paper-plane"></i> Enviar Formulário e Gerar PDF
                </button>
                <button id="voltarEditar" type="button" class="btn btn-secondary">
                    <i class="fas fa-edit"></i> Voltar para Editar
                </button>
            </div>
        </section>
    </main>

    <!-- Pop-up de confirmação (inicialmente oculto) -->
    <div id="confirmPopup" class="popup-overlay" style="display: none;">
        <div class="popup-content">
            <h3><i class="fas fa-check-circle"></i> Formulário Enviado com Sucesso!</h3>
            <p>O formulário foi enviado e um PDF foi gerado. Você pode baixá-lo agora.</p>
            <p>Uma cópia será salva em nossos registros e um e‑mail de confirmação será enviado para você.</p>
            <div class="popup-actions">
                <button id="downloadPDF" class="btn btn-primary">
                    <i class="fas fa-download"></i> Baixar PDF
                </button>
                <button id="closePopup" class="btn btn-secondary">
                    <i class="fas fa-times"></i> Cancelar (Voltar ao Início)
                </button>
            </div>
        </div>
    </div>

    <!-- Rodapé -->
    <footer class="footer">
        <div class="container">
            <p>© 2025 Clínica Dra. Jaqueline Nobre Moratore. Todos os direitos reservados.</p>
            <p>Este formulário é confidencial e segue a Lei Geral de Proteção de Dados (LGPD).</p>
        </div>
    </footer>

    <!-- Script principal -->
    <script src="script.js"></script>
</body>
</html>
